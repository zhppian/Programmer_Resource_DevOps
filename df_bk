# --- Build React Frontend ---
    FROM node:20 as frontend
    WORKDIR /app/frontend
    COPY frontend/package*.json ./
    RUN npm install
    COPY frontend/ ./
    RUN npm run build
    
    # --- Build Python Backend ---
    FROM python:3.13-slim as backend
    WORKDIR /app/backend
    COPY backend/ /app/backend/
    COPY backend/requirements.txt .
    RUN pip install --no-cache-dir -r requirements.txt
    
    # --- Run Backend with Frontend Static Files ---
    COPY --from=frontend /app/frontend/build/ /app/backend/static/
    
    # Expose port for Flask
    EXPOSE 5000
    
    # --- Run Flask and React in Parallel ---
    CMD ["sh", "-c", "cd /app/backend && python app.py & cd /app/frontend && npm start"]
    